Bootstrap: docker
From: python:3.13-slim

%labels
    Author Nolan Welch

%setup
    mkdir -p $SINGULARITY_ROOTFS/app
    cp -r ./syllable_analysis $SINGULARITY_ROOTFS/app
    cp ./pyproject.toml $SINGULARITY_ROOTFS/app
    cp ./README.md $SINGULARITY_ROOTFS/app

%post
    export DEBIAN_FRONTEND=noninteractive

    # Configure the timezone to America/New_York
    ln -fs /usr/share/zoneinfo/America/New_York /etc/localtime
    echo "America/New_York" > /etc/timezone

    # Install project dependencies into the container
    cd /app
    pip install --no-cache-dir --root-user-action=ignore .

    # Remove pip cache to save space
    rm -rf /root/.cache/pip

    # We can remove source code to save a bit of space,
    #   since we've already installed the module.
    cd /root && rm -rf /app

%environment
    export PYTHONNOUSERSITE=1

%runscript
    exec python -m syllable_analysis "$@"